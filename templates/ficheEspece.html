<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>{{taxon.lb_nom}}</title>

        <!-- Bootrap -->
        <link rel="stylesheet" href="{{url_for('static', filename='/lib/bootstrap/css/bootstrap.min.css') }}"></link>
        <link rel="stylesheet" href="{{url_for('static', filename='/lib/bootstrap-switch/css/bootstrap-switch.min.css') }}"></link>


        <!-- Jquery -->
        <link rel="stylesheet" href="{{url_for('static', filename='lib/jquery-ui.css') }}" />
        <script type=text/javascript src="{{url_for('static', filename='lib/jquery-1.12.4.min.js') }}"></script>
        <script type=text/javascript src="{{url_for('static', filename='lib/jquery-ui.min.js') }}"></script>


        <script src="{{url_for('static', filename='/lib/bootstrap-switch/js/bootstrap-switch.min.js') }}"></script>


        <!-- Leaflet -->
        <link rel="stylesheet" href="{{url_for('static', filename='/lib/leaflet/leaflet.css') }}" />
        <link rel="stylesheet" href="{{url_for('static', filename='/css/ficheEspece.css') }}" />
        <script src="{{url_for('static', filename='/lib/leaflet/leaflet.js') }}"></script>
        <script src="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js"></script>
        <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />
        <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />

    </head>

    <body>
    {% include 'navbar.html' %}


    <div id ="page" class="container-fluid">
        <div class='row' id="presentationEspece">
                <div class="col-sm-2" > 
                    <img src="{{url_for('static', filename='/images/pne.jpg') }}" style="width:200px;height:200px;">
                </div>
                <div class="col-sm-3" > 
                    <h3> {{taxon.lb_nom}} </h3>
                    <p> <i> {{taxon.nom_vern}} </i> <br/>
                    Nombre d'observation sur le parc: <i> {{observations.features|length}} </i> </br>

                    <a href='https://inpn.mnhn.fr/espece/cd_nom/{{taxon.cd_nom}}' target="_blank">Fiche INPN</a>
                </div>
       </div>

        <div class="row" id="mapOptions">

            
            <input type="checkbox" name="my-checkbox" id="checkbox" checked  data-on-text="Cluster"data-off-text="Point" data-size="mini">
            <div id="slider"></div>
            <p id="nbObs"> </p>

            
        </div>

        <div id="mapRow" class="row">
            <div id='mapContainer' class="row col-sm-12">
                <div id="map"> </div>
            </div>
        </div>

    </div>


    

    <script type="text/javascript" src="/atlas/static/conf/custom.js"></script>

    <script src="{{url_for('static', filename='map.js') }}"></script>
    <script src="{{url_for('static', filename='main.js') }}"></script>

<!--  Lancement des fonction JS necessitant la syntaxe Jinja-->
    <script type="text/javascript">
    autocompleteTaxons({{ listeTaxons|tojson }})



    displayFilterMarkers({{observations|tojson}})

    var compteur = 0;

      slider.on("slide", function(event, ui){
        year = ui.value;
        if(compteur == 0){
        map.removeLayer(clusterMarkers);
        loadfilterLayer({{observations|tojson}}, year)
        }else{
            map.removeLayer(newClusterMarker)
            loadfilterLayer({{observations|tojson}}, year)
        }
        compteur++;
      })


    </script>


    </body>
</html>
